import t from"typedarray-to-buffer";import e from"atob";const i="undefined"!=typeof document&&"function"==typeof document.createElement,s=i?["webp","jpeg"]:["png"];let r;class o{constructor(t,e=s,i=.5){if(this.quality=void 0,this.types=void 0,this.canvas=void 0,e.length>2)throw new Error("Too many image types are specified!");this.canvas=t,this.quality=i,this.types=e}composeMimeType(t){let e;return this.types[t]&&(e="image/"+this.types[t]),e}isMatch(t,e){return t.match(e)}getTestCanvas(){let t;return i?(t=document.createElement("canvas"),t.width=t.height=1):t=this.canvas,t}canvasSupportsMimeType(t){try{const e=this.getTestCanvas(),i=e.toDataURL&&e.toDataURL(t);return this.isMatch(i,t)}catch(t){return!1}}figureMimeType(){let t=this.composeMimeType(0);return t&&this.canvasSupportsMimeType(t)||(this.types[1]?(t=this.composeMimeType(1),t&&!this.canvasSupportsMimeType(t)&&(t=void 0)):t=void 0),t}uriToBuffer(i){const s=i.split(",")[1];let r;if(!s)throw new Error("Empty uri string given!");if("function"!=typeof e)throw new Error("atob function is missing");r=e(s);const o=new Uint8Array(r.length);for(let t=0,e=r.length;t<e;t++)o[t]=r.charCodeAt(t);return t(o)}toBuffer(){const t=this.getMimeType();let e;if(t){const i=this.canvas.toDataURL(t,this.quality);e=this.uriToBuffer(i)}return e}getMimeType(){return r&&i||(r=this.figureMimeType()),r}}o.atob=void 0;export{o as default};
//# sourceMappingURL=canvas-to-buffer.modern.js.map
